package main

import (
	"crypto/rand"
	"crypto/rsa"
	"crypto/x509"
	"encoding/base64"
	"encoding/pem"
	"fmt"
	"os"
	"strings"
)

func generateRSAKeys(bits int) (*rsa.PrivateKey, error) {
	// Generate RSA key pair
	privateKey, err := rsa.GenerateKey(rand.Reader, bits)
	if err != nil {
		return nil, err
	}

	// Validate the key
	err = privateKey.Validate()
	if err != nil {
		return nil, err
	}

	return privateKey, nil
}

func savePrivateKey(filename string, key *rsa.PrivateKey) error {
	// Create file
	file, err := os.Create(filename)
	if err != nil {
		return err
	}
	defer file.Close()

	// Encode to PEM format
	privBlock := &pem.Block{
		Type:  "RSA PRIVATE KEY",
		Bytes: x509.MarshalPKCS1PrivateKey(key),
	}

	return pem.Encode(file, privBlock)
}

func savePublicKey(filename string, key *rsa.PublicKey) error {
	// Create file
	file, err := os.Create(filename)
	if err != nil {
		return err
	}
	defer file.Close()

	// Encode to PEM format
	pubBytes, err := x509.MarshalPKIXPublicKey(key)
	if err != nil {
		return err
	}

	pubBlock := &pem.Block{
		Type:  "PUBLIC KEY",
		Bytes: pubBytes,
	}

	return pem.Encode(file, pubBlock)
}

func displayKeysToConsole(privateKey *rsa.PrivateKey) {
	// 1. Display PRIVATE KEY
	fmt.Println("=" + strings.Repeat("=", 78) + "=")
	fmt.Println("RSA PRIVATE KEY (PEM Format)")
	fmt.Println("=" + strings.Repeat("=", 78) + "=")

	// Private key in PEM format
	privatePEM := pem.EncodeToMemory(&pem.Block{
		Type:  "RSA PRIVATE KEY",
		Bytes: x509.MarshalPKCS1PrivateKey(privateKey),
	})
	fmt.Println(string(privatePEM))

	// 2. Display PUBLIC KEY
	fmt.Println("\n" + strings.Repeat("-", 80))
	fmt.Println("RSA PUBLIC KEY (PEM Format)")
	fmt.Println(strings.Repeat("-", 80))

	// Public key in PEM format
	publicBytes, _ := x509.MarshalPKIXPublicKey(&privateKey.PublicKey)
	publicPEM := pem.EncodeToMemory(&pem.Block{
		Type:  "PUBLIC KEY",
		Bytes: publicBytes,
	})
	fmt.Println(string(publicPEM))

	// 3. Display in Base64 (for easy copying)
	fmt.Println("\n" + strings.Repeat("-", 80))
	fmt.Println("KEYS IN BASE64 (for single-line copying)")
	fmt.Println(strings.Repeat("-", 80))

	// Encode to base64
	encodedPrivate := base64.StdEncoding.EncodeToString(x509.MarshalPKCS1PrivateKey(privateKey))
	encodedPublic := base64.StdEncoding.EncodeToString(publicBytes)

	fmt.Println("\nPrivate Key (Base64):")
	fmt.Println(encodedPrivate)

	fmt.Println("\nPublic Key (Base64):")
	fmt.Println(encodedPublic)
}

func main() {
	// Generate 2048-bit RSA keys
	privateKey, err := generateRSAKeys(2048)
	if err != nil {
		panic(err)
	}

	// Save keys to files
	savePrivateKey("private.pem", privateKey)
	savePublicKey("public.pem", &privateKey.PublicKey)

	fmt.Println("RSA Keys generated Successfully!")
	fmt.Println("\nKeys have been saved to:")
	fmt.Println("  - private.pem")
	fmt.Println("  - public.pem")

	// Display keys to console
	displayKeysToConsole(privateKey)

	fmt.Println("\n" + strings.Repeat("*", 80))
	fmt.Println("IMPORTANT: Keep your private key secure!")
	fmt.Println(strings.Repeat("*", 80))
}
/*
go run main.go
RSA Keys generated Successfully!

Keys have been saved to:
  - private.pem
  - public.pem
================================================================================
RSA PRIVATE KEY (PEM Format)
================================================================================
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA8t3yvg9iXrHFUVzr1ngRotVexgb1jF94/5SbQeXQfOkIxPzJ
86EEKjN8Eg2E6UGxLUw65oncMa4PTZhzZQtxl6IJ9nGhwAFBnlRWCvEzfqlH63U1
4+WFqWkIMqld3z6L6vsrX5Q5M19L9AYhqNDtQ3YHe9i4rJlJ1N/lcHu1Fm3KLmuC
ylVhIKcTpepHGmYtVFEtUR6gK54hn+FT3JB+xqPcilobUQ3Sdr3EFhaeJdiCn7oG
Cjit1VJEXWNuNKiDiGmzBp4pzdDtxfhWQlDZq+u1GvDqS0/fwviqtQuLwWP3a/AI
pJgajLzHdQqmMNnKe7xOgYIC4TxC3vpyqtRK2wIDAQABAoIBACBhm1Xf8zuw9CAP
BZrI04EkdchtcRvQNu/Mvo6gt5WP9I1fLwX+t/Fwf+BgURJQofDqMwg95U/yZzPv
WaNlTTXscuua5vgUss0LbZVz52vB4kbwj8jc919JE8C9eDilvD4OUxAhUScaU6Qr
lR1PDfNqr0DB+o14urFZUNwYgmKE6mhKxOa9DqAq5Ivh+H4TKVr2TzZwSybo1hFS
fnPw/JMg1beUF0I1SjtJ5AeQXhmn4Ope+klRFDFz3xCyPBRbS0q7tbfFlVeU81Iz
jMu17e+oRS124kGa4LCxXydEUz6fwGzKe5t/bENZPkdS1P+1YBbGDPxEqsKgk4If
0e3I6BECgYEA9AOsx5Ub3HiKyGIPYPKXKCqry5tvGKFcYIMeLq/bE3KwwTXZzMi6
MQg+oOnHdiGS4YUy6/sECngIXJa/HhJqSfDAZGT8h1EI2DFLtVuictRWHS4JlCgw
6tabnxKtJdukHG0csSwxhYfy8QMTPI7cVCVz/7RBBZW/sANZsq/oAKcCgYEA/svY
iVu4+uxjLC/q8WeC3SOP31CQ1n2KyxGc47YwKO/UJN5wSTEQLN6zqH3rfyVv6vvx
yIut4oOMkicM8Llvg2u+n1TVk1X7vQKwhnAff+7IItxvz8PuFIS1LSG1zmcJ42rJ
9HIo1JJAF7P4VzfdPbrxp0U1EIjayjWXI4tGlq0CgYA1Ia+3bXI5mU2uwBtVIr1j
E5eAqAGSvV/d6+7gf44WN/zgtRcNjg9sqbzpUL4LrNfMnzItS+TfWq+HaZOHur7G
BtP9iDesRyrD2EgB30gJ9M4jYGjZh77PA5ezFV/6RE8BmYiL03Gc/7MYY3EG2JyE
/fq6DMezrZ2ld7VKQR8lNQKBgQC1es29cCY+Gxa8B1lJHlgYWFcGUSUIkRzFbMMZ
cc+1qLSqmgDSMO77dpfyP9X3ltuzPEZHeC2e8+Gwy72sy/eAXMLGS69fpNOMGZlP
+BaHkbTdF7NQAZbW6Hr/LU6IN93ULGCyConIdm7OMzKENNcRO9EZOfME1uU3N5py
B6Z8dQKBgQDmIuLxgyQfFO7SKCi9kBNenl1T4AiT1ob3bYkvMYWdM3uKg9Accre3
USuiWOpXFqF7Y6ho2D5JfiziQczuRQqkHQE5AXJKUrXGIlY3HOgpAZyacheyZO/S
bqYl8Sp7P9v/YKTYLQOlC9rdQelhMF48VeOo8ECxAv2fFOE7LCh9vw==
-----END RSA PRIVATE KEY-----


--------------------------------------------------------------------------------
RSA PUBLIC KEY (PEM Format)
--------------------------------------------------------------------------------
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8t3yvg9iXrHFUVzr1ngR
otVexgb1jF94/5SbQeXQfOkIxPzJ86EEKjN8Eg2E6UGxLUw65oncMa4PTZhzZQtx
l6IJ9nGhwAFBnlRWCvEzfqlH63U14+WFqWkIMqld3z6L6vsrX5Q5M19L9AYhqNDt
Q3YHe9i4rJlJ1N/lcHu1Fm3KLmuCylVhIKcTpepHGmYtVFEtUR6gK54hn+FT3JB+
xqPcilobUQ3Sdr3EFhaeJdiCn7oGCjit1VJEXWNuNKiDiGmzBp4pzdDtxfhWQlDZ
q+u1GvDqS0/fwviqtQuLwWP3a/AIpJgajLzHdQqmMNnKe7xOgYIC4TxC3vpyqtRK
2wIDAQAB
-----END PUBLIC KEY-----


--------------------------------------------------------------------------------
KEYS IN BASE64 (for single-line copying)
--------------------------------------------------------------------------------

Private Key (Base64):
MIIEpAIBAAKCAQEA8t3yvg9iXrHFUVzr1ngRotVexgb1jF94/5SbQeXQfOkIxPzJ86EEKjN8Eg2E6UGxLUw65oncMa4PTZhzZQtxl6IJ9nGhwAFBnlRWCvEzfqlH63U14+WFqWkIMqld3z6L6vsrX5Q5M19L9AYhqNDtQ3YHe9i4rJlJ1N/lcHu1Fm3KLmuCylVhIKcTpepHGmYtVFEtUR6gK54hn+FT3JB+xqPcilobUQ3Sdr3EFhaeJdiCn7oGCjit1VJEXWNuNKiDiGmzBp4pzdDtxfhWQlDZq+u1GvDqS0/fwviqtQuLwWP3a/AIpJgajLzHdQqmMNnKe7xOgYIC4TxC3vpyqtRK2wIDAQABAoIBACBhm1Xf8zuw9CAPBZrI04EkdchtcRvQNu/Mvo6gt5WP9I1fLwX+t/Fwf+BgURJQofDqMwg95U/yZzPvWaNlTTXscuua5vgUss0LbZVz52vB4kbwj8jc919JE8C9eDilvD4OUxAhUScaU6QrlR1PDfNqr0DB+o14urFZUNwYgmKE6mhKxOa9DqAq5Ivh+H4TKVr2TzZwSybo1hFSfnPw/JMg1beUF0I1SjtJ5AeQXhmn4Ope+klRFDFz3xCyPBRbS0q7tbfFlVeU81IzjMu17e+oRS124kGa4LCxXydEUz6fwGzKe5t/bENZPkdS1P+1YBbGDPxEqsKgk4If0e3I6BECgYEA9AOsx5Ub3HiKyGIPYPKXKCqry5tvGKFcYIMeLq/bE3KwwTXZzMi6MQg+oOnHdiGS4YUy6/sECngIXJa/HhJqSfDAZGT8h1EI2DFLtVuictRWHS4JlCgw6tabnxKtJdukHG0csSwxhYfy8QMTPI7cVCVz/7RBBZW/sANZsq/oAKcCgYEA/svYiVu4+uxjLC/q8WeC3SOP31CQ1n2KyxGc47YwKO/UJN5wSTEQLN6zqH3rfyVv6vvxyIut4oOMkicM8Llvg2u+n1TVk1X7vQKwhnAff+7IItxvz8PuFIS1LSG1zmcJ42rJ9HIo1JJAF7P4VzfdPbrxp0U1EIjayjWXI4tGlq0CgYA1Ia+3bXI5mU2uwBtVIr1jE5eAqAGSvV/d6+7gf44WN/zgtRcNjg9sqbzpUL4LrNfMnzItS+TfWq+HaZOHur7GBtP9iDesRyrD2EgB30gJ9M4jYGjZh77PA5ezFV/6RE8BmYiL03Gc/7MYY3EG2JyE/fq6DMezrZ2ld7VKQR8lNQKBgQC1es29cCY+Gxa8B1lJHlgYWFcGUSUIkRzFbMMZcc+1qLSqmgDSMO77dpfyP9X3ltuzPEZHeC2e8+Gwy72sy/eAXMLGS69fpNOMGZlP+BaHkbTdF7NQAZbW6Hr/LU6IN93ULGCyConIdm7OMzKENNcRO9EZOfME1uU3N5pyB6Z8dQKBgQDmIuLxgyQfFO7SKCi9kBNenl1T4AiT1ob3bYkvMYWdM3uKg9Accre3USuiWOpXFqF7Y6ho2D5JfiziQczuRQqkHQE5AXJKUrXGIlY3HOgpAZyacheyZO/SbqYl8Sp7P9v/YKTYLQOlC9rdQelhMF48VeOo8ECxAv2fFOE7LCh9vw==

Public Key (Base64):
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8t3yvg9iXrHFUVzr1ngRotVexgb1jF94/5SbQeXQfOkIxPzJ86EEKjN8Eg2E6UGxLUw65oncMa4PTZhzZQtxl6IJ9nGhwAFBnlRWCvEzfqlH63U14+WFqWkIMqld3z6L6vsrX5Q5M19L9AYhqNDtQ3YHe9i4rJlJ1N/lcHu1Fm3KLmuCylVhIKcTpepHGmYtVFEtUR6gK54hn+FT3JB+xqPcilobUQ3Sdr3EFhaeJdiCn7oGCjit1VJEXWNuNKiDiGmzBp4pzdDtxfhWQlDZq+u1GvDqS0/fwviqtQuLwWP3a/AIpJgajLzHdQqmMNnKe7xOgYIC4TxC3vpyqtRK2wIDAQAB

********************************************************************************
IMPORTANT: Keep your private key secure!
********************************************************************************
*/