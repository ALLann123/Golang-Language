package main

import (
	"fmt"
	"log"

	"golang.org/x/sys/windows/registry"
)

func main() {
	//Open registry key for auto-start
	key, _, err := registry.CreateKey(
		registry.CURRENT_USER,
		"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
		registry.ALL_ACCESS,
	)

	if err != nil {
		log.Fatal(err)
	}
	defer key.Close()

	//Set your shell.exe to run at startup
	//Replace "MyApp" with your desired entry name and provide full path to exe
	err = key.SetStringValue("Calc", "C:\\Windows\\System32\\calc.exe")

	if err != nil {
		log.Fatal(err)
	}

	fmt.Println("[+Success! shell.exe added to startup]")
}
